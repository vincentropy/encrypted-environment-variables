#!/bin/bash
# Decrypt .env.enc using sops and output export statements for each variable

set -e

if [ ! -f .env.enc ]; then
  echo ".env.enc not found in current directory."
  exit 1
fi

# Decrypt and output export statements for each variable
XDG_CONFIG_HOME=$HOME/.config sops decrypt --filename-override .env .env.enc | while IFS= read -r line; do
  # Skip empty lines and comments
  if [[ -z "$line" || "$line" =~ ^# ]]; then
    continue
  fi
  echo "export $line"
done
